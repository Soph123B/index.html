<title>Futuristic Blue Space Piano</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');

  :root {
    --primary-blue: #00ffff;
    --secondary-blue: #0080ff;
    --dark-blue: #000066;
  }

  body {
    margin: 0;
    padding: 0;
    background: linear-gradient(135deg, #000033, var(--dark-blue), #000099);
    color: var(--primary-blue);
    font-family: 'Orbitron', sans-serif;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    overflow-x: hidden;
  }

  h1 {
    font-size: 3em;
    text-shadow: 0 0 10px var(--primary-blue), 0 0 20px var(--primary-blue), 0 0 30px var(--primary-blue);
    margin-bottom: 20px;
    text-align: center;
  }

  #keyboard {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    max-width: 1200px;
    background: rgba(0, 0, 0, 0.3);
    padding: 20px;
    border-radius: 20px;
    box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
  }

  .key {
    width: 70px;
    height: 70px;
    margin: 5px;
    background-color: rgba(0, 128, 255, 0.2);
    border: 2px solid var(--primary-blue);
    border-radius: 15px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .key:hover {
    background-color: rgba(0, 128, 255, 0.4);
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 5px 15px rgba(0, 255, 255, 0.5);
  }

  .key:active, .key.active {
    background-color: rgba(0, 128, 255, 0.6);
    transform: scale(0.95) translateY(0);
  }

  .key span {
    font-size: 24px;
    color: var(--primary-blue);
    z-index: 2;
    text-shadow: 0 0 5px var(--primary-blue);
  }

  .key::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(0, 255, 255, 0.2) 0%, rgba(0, 0, 0, 0) 70%);
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .key:hover::before {
    opacity: 1;
  }

  #visualizer-container {
    width: 100%;
    height: 200px;
    margin-top: 20px;
    position: relative;
    overflow: hidden;
  }

  #visualizer {
    width: 100%;
    height: 100%;
  }

  #controls {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 20px;
    gap: 10px;
  }

  .control {
    margin: 0 10px;
    padding: 10px 20px;
    background-color: rgba(0, 128, 255, 0.2);
    border: 2px solid var(--primary-blue);
    border-radius: 10px;
    color: var(--primary-blue);
    cursor: pointer;
    transition: all 0.3s ease;
    font-family: 'Orbitron', sans-serif;
    font-size: 16px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .control:hover {
    background-color: rgba(0, 128, 255, 0.4);
    transform: translateY(-3px);
    box-shadow: 0 3px 10px rgba(0, 255, 255, 0.3);
  }

  #space-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    pointer-events: none;
  }

  .slider-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 10px;
  }

  .slider-container label {
    margin-bottom: 5px;
    color: var(--primary-blue);
  }

  input[type="range"] {
    -webkit-appearance: none;
    width: 200px;
    height: 10px;
    background: rgba(0, 128, 255, 0.2);
    outline: none;
    border-radius: 5px;
  }

  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 20px;
    height: 20px;
    background: var(--primary-blue);
    cursor: pointer;
    border-radius: 50%;
  }

  input[type="range"]::-moz-range-thumb {
    width: 20px;
    height: 20px;
    background: var(--primary-blue);
    cursor: pointer;
    border-radius: 50%;
  }

  #settings-panel {
    background: rgba(0, 0, 0, 0.5);
    padding: 20px;
    border-radius: 15px;
    margin-top: 20px;
    display: none;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
    border: 2px solid var(--secondary-blue);
    box-shadow: 0 0 15px var(--secondary-blue);
  }

  .glow-effect {
    animation: glow 2s ease-in-out infinite alternate;
  }

  @keyframes glow {
    from {
      box-shadow: 0 0 5px var(--primary-blue), 0 0 10px var(--primary-blue);
    }
    to {
      box-shadow: 0 0 10px var(--primary-blue), 0 0 20px var(--primary-blue), 0 0 30px var(--primary-blue);
    }
  }

  .floating {
    animation: float 3s ease-in-out infinite;
  }

  @keyframes float {
    0% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
    100% { transform: translateY(0px); }
  }

  #current-waveform {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 18px;
    color: var(--primary-blue);
    text-shadow: 0 0 5px var(--primary-blue);
  }
</style>
</head>
<body>
<div id="space-background"></div>
<h1 class="glow-effect">Futuristic Blue Space Piano</h1>
<div id="keyboard" class="floating"></div>
<div id="visualizer-container">
  <canvas id="visualizer"></canvas>
</div>
<div id="controls">
  <button class="control glow-effect" id="waveformBtn">Change Waveform</button>
  <button class="control glow-effect" id="effectBtn">Toggle Effect</button>
  <button class="control glow-effect" id="settingsBtn">Settings</button>
</div>
<div id="settings-panel">
  <div class="slider-container">
    <label for="attack">Attack</label>
    <input type="range" id="attack" min="0.01" max="2" step="0.01" value="0.02">
  </div>
  <div class="slider-container">
    <label for="decay">Decay</label>
    <input type="range" id="decay" min="0.01" max="2" step="0.01" value="0.1">
  </div>
  <div class="slider-container">
    <label for="sustain">Sustain</label>
    <input type="range" id="sustain" min="0" max="1" step="0.01" value="0.3">
  </div>
  <div class="slider-container">
    <label for="release">Release</label>
    <input type="range" id="release" min="0.01" max="5" step="0.01" value="1">
  </div>
  <div class="slider-container">
    <label for="reverbDecay">Reverb Decay</label>
    <input type="range" id="reverbDecay" min="0.1" max="10" step="0.1" value="5">
  </div>
  <div class="slider-container">
    <label for="chorusFreq">Chorus Frequency</label>
    <input type="range" id="chorusFreq" min="0.1" max="10" step="0.1" value="4">
  </div>
  <div class="slider-container">
    <label for="chorusDepth">Chorus Depth</label>
    <input type="range" id="chorusDepth" min="0" max="1" step="0.01" value="0.5">
  </div>
</div>
<div id="current-waveform"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.38/Tone.js"></script>
<script>
const keys = 'QWERTYUIOPASDFGHJKLZXCVBNM1234567890';
const frequencies = Array.from({length: keys.length}, (_, i) => 110 * Math.pow(2, i / 12));
const keyElements = {};
let activeOscillators = {};

const reverb = new Tone.Reverb({
  decay: 5,
  wet: 0.5
}).toDestination();

const chorus = new Tone.Chorus({
  frequency: 4,
  delayTime: 2.5,
  depth: 0.5,
  wet: 0.5
}).connect(reverb);

const limiter = new Tone.Limiter(-3).connect(chorus);

const analyzer = new Tone.Analyser('waveform', 2048);
limiter.connect(analyzer);

let currentWaveform = 'sawtooth';
let effectEnabled = true;

const keyboardElement = document.getElementById('keyboard');
keys.split('').forEach((key, index) => {
  const keyElement = document.createElement('div');
  keyElement.className = 'key';
  keyElement.innerHTML = `<span>${key}</span>`;
  keyboardElement.appendChild(keyElement);
  keyElements[key] = keyElement;

  keyElement.addEventListener('mousedown', () => startNote(key));
  keyElement.addEventListener('mouseup', () => stopNote(key));
  keyElement.addEventListener('mouseleave', () => stopNote(key));
});

document.addEventListener('keydown', (event) => {
  const key = event.key.toUpperCase();
  if (keys.includes(key) && !event.repeat) {
    startNote(key);
  }
});

document.addEventListener('keyup', (event) => {
  const key = event.key.toUpperCase();
  if (keys.includes(key)) {
    stopNote(key);
  }
});

function createSynth() {
  return new Tone.Synth({
    oscillator: {
      type: currentWaveform
    },
    envelope: {
      attack: parseFloat(document.getElementById('attack').value),
      decay: parseFloat(document.getElementById('decay').value),
      sustain: parseFloat(document.getElementById('sustain').value),
      release: parseFloat(document.getElementById('release').value)
    }
  }).connect(limiter);
}

function startNote(key) {
  if (activeOscillators[key]) return;

  const frequency = frequencies[keys.indexOf(key)];
  const synth = createSynth();
  synth.triggerAttack(frequency);
  activeOscillators[key] = synth;

  keyElements[key].classList.add('active');
}

function stopNote(key) {
  if (!activeOscillators[key]) return;

  const synth = activeOscillators[key];
  synth.triggerRelease();
  setTimeout(() => synth.dispose(), 2000);

  delete activeOscillators[key];

  keyElements[key].classList.remove('active');
}

// Futuristic Visualizer
const canvas = document.getElementById('visualizer');
const canvasCtx = canvas.getContext('2d');

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = 200;
}

window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function drawVisualizer() {
  requestAnimationFrame(drawVisualizer);

  const bufferLength = analyzer.size;
  const dataArray = analyzer.getValue();

  canvasCtx.fillStyle = 'rgba(0, 0, 51, 0.1)';
  canvasCtx.fillRect(0, 0, canvas.width, canvas.height);

  canvasCtx.lineWidth = 2;
  canvasCtx.strokeStyle = '#00ffff';

  const centerY = canvas.height / 2;
  const scale = 100;

  // Main waveform
  canvasCtx.beginPath();
  for (let i = 0; i < bufferLength; i++) {
    const x = (i / bufferLength) * canvas.width;
    const y = centerY + dataArray[i] * scale;
    canvasCtx.lineTo(x, y);
  }
  canvasCtx.stroke();

  // Mirror waveform
  canvasCtx.beginPath();
  for (let i = 0; i < bufferLength; i++) {
    const x = (i / bufferLength) * canvas.width;
    const y = centerY - dataArray[i] * scale;
    canvasCtx.lineTo(x, y);
  }
  canvasCtx.stroke();

  // Frequency bars
  const barWidth = canvas.width / bufferLength * 2;
  const barSpacing = 2;
  canvasCtx.fillStyle = 'rgba(0, 255, 255, 0.5)';
  for (let i = 0; i < bufferLength; i++) {
    const barHeight = Math.abs(dataArray[i]) * scale;
    canvasCtx.fillRect(i * (barWidth + barSpacing), canvas.height - barHeight / 2, barWidth, barHeight / 2);
  }

  // Particle effect
  const particleCount = 100;
  canvasCtx.fillStyle = '#00ffff';
  for (let i = 0; i < particleCount; i++) {
    const x = Math.random() * canvas.width;
    const y = Math.random() * canvas.height;
    const size = Math.random() * 2 + 1;
    canvasCtx.beginPath();
    canvasCtx.arc(x, y, size, 0, Math.PI * 2);
    canvasCtx.fill();
  }
}

drawVisualizer();

// Controls
document.getElementById('waveformBtn').addEventListener('click', () => {
  const waveforms = ['sawtooth', 'sine', 'square', 'triangle'];
  currentWaveform = waveforms[(waveforms.indexOf(currentWaveform) + 1) % waveforms.length];
  Object.values(activeOscillators).forEach(synth => {
    synth.oscillator.type = currentWaveform;
  });
  updateCurrentWaveform();
});

document.getElementById('effectBtn').addEventListener('click', () => {
  effectEnabled = !effectEnabled;
  if (effectEnabled) {
    limiter.connect(chorus);
  } else {
    limiter.disconnect();
    limiter.toDestination();
  }
});

document.getElementById('settingsBtn').addEventListener('click', () => {
  const settingsPanel = document.getElementById('settings-panel');
  settingsPanel.style.display = settingsPanel.style.display === 'none' ? 'flex' : 'none';
});

// Settings listeners
['attack', 'decay', 'sustain', 'release'].forEach(param => {
  document.getElementById(param).addEventListener('input', (e) => {
    Object.values(activeOscillators).forEach(synth => {
      synth.envelope[param] = parseFloat(e.target.value);
    });
  });
});

document.getElementById('reverbDecay').addEventListener('input', (e) => {
  reverb.decay = parseFloat(e.target.value);
});

document.getElementById('chorusFreq').addEventListener('input', (e) => {
  chorus.frequency.value = parseFloat(e.target.value);
});

document.getElementById('chorusDepth').addEventListener('input', (e) => {
  chorus.depth = parseFloat(e.target.value);
});

// Start audio context on user interaction
document.body.addEventListener('click', () => {
  if (Tone.context.state !== 'running') Tone.context.resume();
});

// Space background
const spaceBackground = document.getElementById('space-background');

function createStar() {
  const star = document.createElement('div');
  star.style.position = 'absolute';
  star.style.width = '2px';
  star.style.height = '2px';
  star.style.backgroundColor = 'white';
  star.style.borderRadius = '50%';
  star.style.left = `${Math.random() * 100}%`;
  star.style.top = `${Math.random() * 100}%`;
  star.style.animation = `twinkle ${Math.random() * 5 + 3}s linear infinite`;
  return star;
}

for (let i = 0; i < 200; i++) {
  spaceBackground.appendChild(createStar());
}

const styleSheet = document.styleSheets[0];
styleSheet.insertRule(`
  @keyframes twinkle {
    0% { opacity: 0; }
    50% { opacity: 1; }
    100% { opacity: 0; }
  }
`, styleSheet.cssRules.length);

// Update current waveform display
function updateCurrentWaveform() {
  const waveformDisplay = document.getElementById('current-waveform');
  waveformDisplay.textContent = `Current Waveform: ${currentWaveform}`;
}

updateCurrentWaveform();

// Add some cool cyan effects
function addCyanEffects() {
  const cyanEffect = document.createElement('div');
  cyanEffect.style.position = 'fixed';
  cyanEffect.style.top = '0';
  cyanEffect.style.left = '0';
  cyanEffect.style.width = '100%';
  cyanEffect.style.height = '100%';
  cyanEffect.style.background = 'radial-gradient(circle, rgba(0,255,255,0.1) 0%, rgba(0,0,0,0) 70%)';
  cyanEffect.style.pointerEvents = 'none';
  cyanEffect.style.zIndex = '-1';
  document.body.appendChild(cyanEffect);

  setInterval(() => {
    cyanEffect.style.opacity = Math.random() * 0.5 + 0.5;
  }, 2000);
}

addCyanEffects();

// Add a cool pulsating effect to the keyboard
function pulsateKeyboard() {
  const keyboard = document.getElementById('keyboard');
  let scale = 1;
  let growing = true;

  setInterval(() => {
    if (growing) {
      scale += 0.001;
      if (scale >= 1.05) growing = false;
    } else {
      scale -= 0.001;
      if (scale <= 1) growing = true;
    }
    keyboard.style.transform = `scale(${scale})`;
  }, 50);
}

pulsateKeyboard();
</script>
</body></html>